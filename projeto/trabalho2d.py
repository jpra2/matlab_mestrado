import numpy as np

T = np.array([
    [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [-16, 32.0032, -16, 0, 0, -0.0032, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, -16, 32.0032, -16, 0, 0, -0.0032, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, -16, 32, 0, 0, 0, -16, 0, 0, 0, 0, 0, 0, 0, 0],
    [-16, 0, 0, 0, 32.0032, 0.0032, 0, 0, -16, 0, 0, 0, 0, 0, 0, 0],
    [0, -0.0032, 0, 0, -0.0032, 0.0096, -0.0016, 0, 0, -0.0016, 0, 0, 0, 0, 0, 0],
    [0, 0, -0.0032, 0, 0, -0.0016, 0.0096, -0.0032, 0, 0, -0.0016, 0, 0, 0, 0, 0],
    [0, 0, 0, -16, 0, 0, -0.0032, 32.0032, 0, 0, 0, -16, 0, 0, 0, 0],
    [0, 0, 0, 0, -16, 0, 0, 0, 32.0032, -0.0032, 0, 0, -16, 0, 0, 0],
    [0, 0, 0, 0, 0, -0.0016, 0, 0, -0.0032, 0.0096, -0.0016, 0, 0, -0.0032, 0, 0],
    [0, 0, 0, 0, 0, 0, -0.0016, 0, 0, -0.0016, 0.0096, -0.0032, 0, 0, -0.0032, 0],
    [0, 0, 0, 0, 0, 0, 0, -16, 0, 0, -0.0032, 32.0032, 0, 0, 0, -16],
    [0, 0, 0, 0, 0, 0, 0, 0, -16, 0, 0, 0, 32, -16, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, -0.0032, 0, 0, -16, 32.0032, -16, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.0032, 0, 0, -16, 32.0032, -16],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
])

q = np.zeros(16)
q[0] = 500
q[-1] = 100

p = np.linalg.solve(T, q)
print(p)

# # a = [500.         433.32295154 366.65480252 299.99998704 433.19337231
# #  388.82581376 299.9870305  233.34517157 366.55114846 299.93520434
# #  211.09642108 166.67702772 299.92224779 233.29334713 166.6511181
# #  100.]